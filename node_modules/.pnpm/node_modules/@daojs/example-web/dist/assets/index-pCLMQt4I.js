(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function s(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(o){if(o.ep)return;o.ep=!0;const i=s(o);fetch(o.href,i)}})();const L=Symbol.for("dao.fragment");function l(e,t,s){return{type:e,props:t,key:s}}const f=l;let h=!1,y=[],b=new Set,p=!1;function w(){p=!1;const e=y;y=[],b=new Set;for(const t of e)t()}function C(e){b.has(e)||(b.add(e),y.push(e),p||(p=!0,queueMicrotask(w)))}function T(e){if(h)return e();h=!0;try{return e()}finally{h=!1,y.length>0&&!p&&(p=!0,queueMicrotask(w))}}function k(){return h}let a=null;function g(e){const t=a;return a=e,t}function A(e){a&&(a.deps.has(e)||(a.deps.add(e),e.subs.add(a)))}function x(e){const t={subs:new Set};let s=e;const c=()=>(A(t),s),o=i=>{const n=typeof i=="function"?i(s):i;if(!Object.is(n,s)){s=n;for(const r of t.subs)k(),C(r.onTrigger)}};return c.set=o,c}let m;function v(e){const t={deps:new Set,onTrigger:()=>{i()}};let s=!1,c;function o(){for(const n of t.deps)n.subs.delete(t);t.deps.clear()}function i(){if(s)return;o();const n=g(t),r=m;m=void 0;try{e()}finally{g(n),c&&c(),c=m,m=r}}return i(),()=>{s=!0,o(),c&&c(),c=void 0}}function q(e){const t={subs:new Set},s={deps:new Set,onTrigger:()=>{r()}};let c=!0,o;function i(){for(const u of s.deps)u.subs.delete(s);s.deps.clear()}function n(){i();const u=g(s);try{o=e()}finally{g(u),c=!1}}function r(){if(!c){c=!0;for(const u of t.subs)C(u.onTrigger)}}return()=>(A(t),c&&n(),o)}function S(e,t){if(e!=null){if(typeof e=="function"){const s=document.createComment("dao:children:start"),c=document.createComment("dao:children:end");t.appendChild(s),t.appendChild(c),v(()=>{let o=s.nextSibling;for(;o&&o!==c;){const n=o.nextSibling;t.removeChild(o),o=n}const i=e();d(i,t),t.insertBefore(c,null)});return}if(Array.isArray(e)){for(const s of e)d(s,t);return}d(e,t)}}function d(e,t){var i;if(e==null||e===!1||e===!0){const n=document.createComment("");return t.appendChild(n),n}if(typeof e=="string"||typeof e=="number"){const n=document.createTextNode(String(e));return t.appendChild(n),n}if(Array.isArray(e)){const n=document.createComment("");t.appendChild(n);for(const r of e)d(r,t);return n}if(typeof e=="function"){const n=document.createComment("dao:start"),r=document.createComment("dao:end");return t.appendChild(n),t.appendChild(r),v(()=>{let u=n.nextSibling;for(;u&&u!==r;){const j=u.nextSibling;t.removeChild(u),u=j}const O=e();d(O,t),t.insertBefore(r,null)}),r}const s=e;if(s.type===L){const n=document.createComment("");return t.appendChild(n),S((i=s.props)==null?void 0:i.children,t),n}if(typeof s.type=="function"){const n=s.type(s.props??{});return d(n,t)}const c=document.createElement(s.type),o=s.props??{};for(const[n,r]of Object.entries(o))if(n!=="children"){if(n==="class"){c.className=r??"";continue}if(n==="style"&&r&&typeof r=="object"){Object.assign(c.style,r);continue}if(n.startsWith("on")&&typeof r=="function"){const u=n.slice(2).toLowerCase();c.addEventListener(u,r);continue}if(r==null||r===!1){c.removeAttribute(n);continue}c.setAttribute(n,String(r))}return t.appendChild(c),S(o.children,c),c}function B(e,t){return t.textContent="",v(()=>{t.textContent="",d(e(),t)})}function D(){const e=x(0),t=x([{id:1,text:"a"},{id:2,text:"b"},{id:3,text:"c"}]),s=q(()=>e()*2);return f("div",{style:{padding:"16px",fontFamily:"system-ui"},children:[l("h2",{children:"daojs demo"}),f("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[l("button",{onClick:()=>e.set(r=>r+1),children:"+1"}),l("button",{onClick:()=>{T(()=>{e.set(r=>r+1),e.set(r=>r+1)})},children:"batch +2"}),f("div",{children:["count: ",()=>e()]}),f("div",{children:["double: ",()=>s()]})]}),l("hr",{}),f("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[l("button",{onClick:()=>t.set(r=>[{id:Date.now(),text:"new"},...r]),children:"unshift"}),l("button",{onClick:()=>t.set(r=>{const u=[...r];return u.reverse(),u}),children:"reverse"})]}),l("ul",{children:t().map(r=>f("li",{children:[r.id,": ",r.text]},r.id))})]})}B(()=>l(D,{}),document.getElementById("app"));
